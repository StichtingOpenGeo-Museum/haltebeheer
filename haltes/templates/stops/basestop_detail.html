{% extends "base.html" %}
{% load i18n %}
{% block title %} {{ basestop.common_name }} {% endblock %}
{% block page_title %} {{ basestop.common_name }} {% endblock %}

{% block add_css %}
    <link rel="stylesheet" href="{{STATIC_URL}}css/geo/leaflet.css" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="{{STATIC_URL}}css/geo/leaflet.ie.css" />
    <![endif]-->
{% endblock %}

{% block add_js %}
    <script src="{{STATIC_URL}}js/geo/leaflet.js"></script>
    <script src="{{STATIC_URL}}js/geo/proj4js-compressed.js"></script>
    <script src="{{STATIC_URL}}js/geo/proj4leaflet.js"></script>
    <script src="{{STATIC_URL}}js/geo/leaflet_brt.js"></script>
{% endblock %}

{% block content %}
  <h2>{{ basestop.common_name }}</h2>
  <h3>{{ basestop.common_city }}</h3>
  {% if basestop.stop_type == 2 %}
      <p>{% blocktrans with count=basestop.parent.count %}Bevat {{ count }} fysieke haltes{% endblocktrans %}</p>
  {% endif %}
  <a href="{% url 'city_stops' basestop.common_city|lower|escape %}">< {% trans "back" %}</a>
  {% comment %}
      {% for stop in basestop.parent.filter %}
          {{ stop }},
      {% endfor %}
  {% endcomment %}
  <hr>
  <div class="row">
    <div id="map" class="col-md-6"></div>
    <div class="col-md-6">
      <h4>{% trans "Algemene attributen" %}</h4>
      <table class="table table-striped">
      {% if basestop.stop_type == 1 %}
        <tr>
          <td>TPC</td>
          <td><input type="text" value="{{ basestop.tpc }}"></td>
        </tr>
      {% endif %}
      {% for attr in basestop.stopattribute_set.filter %}
        <tr>
          <td>{{ attr.key }}</td>
          <td><input type="text" value="{{ attr.value }}"></td>
        </tr>
      {% endfor %}
      </table>
    </div>
  </div>
    <div class="row">
        <div class="col-md-6">
            <h4>{% trans "Bron attributen" %}</h4>
            <table class="table table-striped table-hover">
                {% for attr in basestop.sourceattribute_set.filter %}
                {% ifchanged attr.source and %}
                {% if not forloop.first %}
            </table>
            <table class="span3">
                {% endif %}
                <tr><th colspan="2">{{ attr.source.name }}</th></tr>
                {% endifchanged %}
                <tr>
                    <td><strong>{{ attr.key }}</strong></td>
                    <td>{{ attr.value }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>

<div class="row">
	<div class="col-md-10">
	<h4>{% trans "Geschiedenis" %}</h4>
	<table class="table table-striped table-hover" style="width: 100%">
		<tr><th>{% trans "Datum" %}</th><th>{% trans "Opmerking" %}</th><th>{% trans "Gebruiker" %}</th></tr>
	{% for version in history %}
		<tr>
			<td>{{ version.revision.date_created|date:"d-m-Y H:i" }}</td>
			<td>{{ version.revision.comment }}</td>
			<td>{{ version.revision.user.name }}</td>
		</tr>
	{% endfor %}
	</table>
	</div>
</div>

<script type="text/javascript">
    function init() {
        var map = new L.Map('map', {
          continuousWorld: true,
          crs: RD,
          layers: [ brt_layer ],
          center: new L.LatLng(52.089398,5.109861),
          zoom: 12
        });
    }
</script>
{% endblock %}
